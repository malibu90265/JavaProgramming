<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="hrPriceDAO" >

	<resultMap type="com.sqisoft.iqs.humanResource.vo.HRPriceVO" id="hrPriceMap">
		<id 	property="hp_position"	column="hp_position"/>
		<id	 	property="hp_team"		column="hp_team"/>
		<result property="hp_mon_cost"	column="hp_mon_cost"/>
		<result property="hp_mon_price"	column="hp_mon_price"/>
	</resultMap>


	<select id="getHRPriceIfoByTeamId" parameterType="string" resultMap="hrPriceMap">
		SELECT 	hp_team
				, hp_position
				, hp_mon_cost
				, hp_mon_price
		FROM	hr_price
		WHERE	hp_team = #{tm_id}
		ORDER	BY	hp_position
	</select>
	
	<!-- hr_price > human_resource > pj_deploy 순으로 업데이트? -->
	<update id="updateHRPriceInfo" parameterType="com.sqisoft.iqs.humanResource.vo.HRPriceVO">
		UPDATE	hr_price
		SET		hp_mon_cost = #{hp_mon_cost}
				, hp_mon_price = #{hp_mon_price}
		WHERE	hp_team = #{hp_team}
		AND		hp_position LIKE CONCAT('%', #{hp_position})
	</update>
	
	<update id="updateHumanResourceInfo" parameterType="com.sqisoft.iqs.humanResource.vo.HRPriceVO" >
		UPDATE	human_resource h, pj_deploy d
		SET		h.hr_uprice = #{hp_mon_price}
				, d.pd_uprice = #{hp_mon_price}
		WHERE	tm_id = #{hp_team} 
		AND		h.hr_name = d.pd_name
		<if test="hp_team != '6M15'">
		AND		hr_position LIKE CONCAT ('%', #{hp_position} )
		</if>
	</update>
	
</mapper>