<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="project_settingDAO" >

<resultMap type="com.sqisoft.iqs.project_setting.vo.Project_settingVO" id="project_settingResultMap">
		<id		property="pj_id"			column="pj_id"/>
		<result	property="pj_name"			column="pj_name"/>
		<result	property="tm_id"			column="tm_id"/>
		<result	property="pj_status"		column="pj_status"/>
		<result	property="pj_sign_client"	column="pj_sign_client"/>
		<result	property="pj_order_client"	column="pj_order_client"/>
		<result	property="pj_amount"		column="pj_amount"/>
		<result	property="pj_LMD"			column="pj_LMD"/>
		<result	property="pj_start_date"	column="pj_start_date"/>
		<result	property="pj_end_date"		column="pj_end_date"/>
		<result	property="pj_stage"			column="pj_stage"/>
		<result	property="pj_propose_date"	column="pj_propose_date"/>
		<result	property="pj_contract_date"	column="pj_contract_date"/>
		<result	property="pj_pm"			column="pj_pm"/>
		<result	property="pj_loc"			column="pj_loc"/>
		<result	property="pj_cwm_env"		column="pj_cwm_env"/>
		<result	property="pj_os"			column="pj_os"/>
		<result	property="pj_DB"			column="pj_DB"/>
		<result	property="pj_ui"			column="pj_ui"/>
		<result	property="pj_lang"			column="pj_lang"/>
		<result	property="pj_fw"			column="pj_fw"/>
		<result	property="pj_mw"			column="pj_mw"/>
		<result	property="pj_req_num"		column="pj_req_num"/>
		<result	property="pj_put_num"		column="pj_put_num"/>
		<result	property="pj_year_sales"	column="pj_year_sales"/>
		<result	property="pj_matl_cost"		column="pj_matl_cost"/>
		<result	property="pj_outsrc_cost"	column="pj_outsrc_cost"/>
		<result	property="pj_extra_cost"	column="pj_extra_cost"/>
		<result	property="pj_sqi_mm"		column="pj_sqi_mm"/>
		<result	property="pj_out_mm"		column="pj_out_mm"/>
	</resultMap>
	
	<resultMap type="com.sqisoft.iqs.project_setting.vo.Skill_envVO" id="project_settingSkillResultMap">
		<result	property="environment_division"		column="environment_division"/>
		<result	property="each_environment"			column="each_environment"/>
	</resultMap>
	
<select id = "getProject_settingList" parameterType ="string" resultMap="project_settingResultMap">
		SELECT pj_id
				, pj_name
				, team.tm_id as tm_id
				, pj_sign_client
				, pj_order_client
				, pj_amount
				, pj_LMD
				, pj_start_date
				, pj_end_date
				, pj_stage
				, pj_propose_date
				, pj_contract_date
				, pj_pm
				, pj_loc
				, pj_cwm_env
				, pj_os
				, pj_DB
				, pj_ui
				, pj_lang
				, pj_fw
				, pj_mw
				, pj_req_num
				, pj_put_num
				, pj_year_sales
				, pj_matl_cost
				, pj_outsrc_cost
				, pj_extra_cost
				, pj_sqi_mm
				, pj_out_mm
		FROM	project, team
		WHERE	team.tm_id = #{tm_id}
		AND		project.tm_id = team.tm_id
</select>

<select id = "getProject_settingInfo" parameterType ="map" resultMap="project_settingResultMap">
		SELECT	pj_id
				, pj_name
				, team.tm_id as tm_id
				, pj_sign_client
				, pj_order_client
				, pj_amount
				, pj_LMD
				, pj_start_date
				, pj_end_date
				, pj_stage
				, pj_propose_date
				, pj_contract_date
				, pj_pm
				, pj_loc
				, pj_cwm_env
				, pj_os
				, pj_DB
				, pj_ui
				, pj_lang
				, pj_fw
				, pj_mw
				, pj_req_num
				, pj_put_num
				, pj_year_sales
				, pj_matl_cost
				, pj_outsrc_cost
				, pj_extra_cost
				, pj_sqi_mm
				, pj_out_mm
		FROM	project, team
		WHERE	team.tm_id = #{tm_id}
		AND		project.tm_id = team.tm_id 
		AND		project.tm_id = #{tm_id}
		AND		pj_id = #{pj_id}
</select>

<select id = "getproject_settingResetInfo" parameterType ="String" resultMap="project_settingResultMap">
		SELECT	pj_id
				, pj_name
				, tm_id
				, pj_sign_client
				, pj_order_client
				, pj_amount
				, pj_LMD
				, pj_start_date
				, pj_end_date
				, pj_stage
				, pj_propose_date
				, pj_contract_date
				, pj_pm
				, pj_loc
				, pj_cwm_env
				, pj_os
				, pj_DB
				, pj_ui
				, pj_lang
				, pj_fw
				, pj_mw
				, pj_req_num
				, pj_put_num
				, pj_year_sales
				, pj_matl_cost
				, pj_outsrc_cost
				, pj_extra_cost
				, pj_sqi_mm
				, pj_out_mm
		FROM	project
		WHERE	pj_id = #{pj_id}
</select>

<select id = "getProject_settingSkillList" resultMap="project_settingSkillResultMap">
		SELECT	environment_division
				, each_environment
		FROM	skill_env
		WHERE	environment_division = #{name}
</select>

<update id="project_settingModifyForm" parameterType="com.sqisoft.iqs.project_setting.vo.Project_settingVO">
		UPDATE	project
		SET		 pj_pm = #{pj_pm}
				, pj_loc = #{pj_loc}
				, pj_cwm_env = #{pj_cwm_env}
				, pj_os = #{pj_os}
				, pj_DB = #{pj_DB}
				, pj_ui = #{pj_ui}
				, pj_lang = #{pj_lang}
				, pj_fw = #{pj_fw}
				, pj_mw = #{pj_mw}
		WHERE	 pj_id = #{pj_id}
	</update>
</mapper>