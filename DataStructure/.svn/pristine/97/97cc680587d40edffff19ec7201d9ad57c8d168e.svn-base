<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="waitingListDAO" >

	<resultMap type="com.sqisoft.iqs.humanResource.waitingList.vo.WaitingListVO" id="waitingListMap">
		<id		property="wa_name"			column="wa_name" />
		<result	property="pj_name"			column="pj_name" />
		<result	property="pd_end_date"		column="pd_end_date" />
		<result	property="tm_id"			column="tm_id" />
		<result	property="wa_from_date"		column="wa_from_date" />
		<result	property="wa_to_date"		column="wa_to_date" />
		<result	property="hr_hire_date"		column="hr_hire_date" />
		<result	property="hr_quit_date"		column="hr_quit_date" />
		<result	property="hr_company"		column="hr_company" />
		<result	property="hr_position"		column="hr_position" />
		<result	property="hr_grade"			column="hr_grade" />
		<result	property="hr_uprice"		column="hr_uprice" />
	</resultMap>
	
	<!-- 리스트 -->
	<!-- 대기 구하기 -->
	<select id="getJanuaryToDecemberList" parameterType="String" resultMap="waitingListMap">
		SELECT  w.wa_name			AS	wa_name
				, p.pj_name			AS	pj_name
				, d.pd_end_date		AS	pd_end_date
				, w.tm_id			AS	tm_id
				, w.wa_from_date	AS	wa_from_date
				, w.wa_to_date 		AS	wa_to_date
				, h.hr_hire_date	AS	hr_hire_date
				, h.hr_quit_date	AS	hr_quit_date
		FROM	project p, pj_deploy d, wait w, human_resource h
		WHERE	p.pj_id = d.pj_id
		AND		w.wa_name = d.pd_name
		AND		w.wa_name = h.hr_name
		AND		w.wa_from_date > pd_end_date
		GROUP	BY w.wa_from_date
		ORDER	BY w.wa_name, d.pd_end_date DESC
	</select>

	<select id="getWaitList" parameterType="string" resultMap="waitingListMap">
		SELECT	w.wa_name AS wa_name, 
				w.tm_id AS tm_id, 
				w.wa_from_date AS wa_from_date, 
				w.wa_to_date AS wa_to_date, 
				hp.hp_mon_price AS hr_uprice,
				h.hr_position as hr_position,
				h.hr_grade as hr_grade
		FROM wait w, human_resource h, hr_price hp
		WHERE w.tm_id = #{tm_id}
		AND w.tm_id = hp.hp_team
		AND w.wa_name = h.hr_name
		AND h.hr_position = hp.hp_position
		ORDER BY w.wa_name
	</select>

</mapper>